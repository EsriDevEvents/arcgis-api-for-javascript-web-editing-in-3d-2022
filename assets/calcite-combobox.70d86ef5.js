import{uk as x,p4 as M,p5 as d,tB as g,ul as T,tT as u,um as $,un as P,pa as a,tS as _,pc as O,pd as V,uo as z,up as v,uq as R}from"./vendor.1dc52be5.js";import{f as q,i as B}from"./forIn.4b06685c.js";import{T as N,C as D,a as I,b as U,g as C,c as X,h as w,d as y}from"./utils2.4b2b6955.js";import{c as Y,d as G,g as j}from"./label.46b81f19.js";import{c as K,a as W,d as J,H as Q}from"./form.a5cd6fd3.js";/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 */function Z(e,t){for(var i=-1,s=e==null?0:e.length,n=Array(s);++i<s;)n[i]=t(e[i],i,e);return n}var ee=1/0,k=x?x.prototype:void 0,E=k?k.toString:void 0;function L(e){if(typeof e=="string")return e;if(B(e))return Z(e,L)+"";if(R(e))return E?E.call(e):"";var t=e+"";return t=="0"&&1/e==-ee?"-0":t}function te(e){return e==null?"":L(e)}var A=/[\\^$.*+?()[\]{}|]/g,ie=RegExp(A.source);function se(e){return e=te(e),e&&ie.test(e)?e.replace(A,"\\$&"):e}const ne=(e,t)=>{const i=se(t),s=new RegExp(i,"i");e.length===0&&console.warn(`No data was passed to the filter function.
    The data argument should be an array of objects`);const n=(r,h)=>{var c;if((c=r)===null||c===void 0?void 0:c.constant)return!0;let p=!1;return q(r,l=>{typeof l!="function"&&(Array.isArray(l)||typeof l=="object"&&l!==null?n(l,h)&&(p=!0):h.test(l)&&(p=!0))}),p};return e.filter(r=>n(r,s))},ae="@-webkit-keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in{0%{opacity:0}100%{opacity:1}}@-webkit-keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}@keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-duration:var(--calcite-animation-timing);animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{-webkit-animation-name:in;animation-name:in}.calcite-animate__in-down{-webkit-animation-name:in-down;animation-name:in-down}.calcite-animate__in-up{-webkit-animation-name:in-up;animation-name:in-up}.calcite-animate__in-scale{-webkit-animation-name:in-scale;animation-name:in-scale}:root{--calcite-popper-transition:var(--calcite-animation-timing)}:host([hidden]){display:none}:host{position:relative;display:block}:host([disabled]){pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;opacity:0.5}:host([scale=s]){font-size:var(--calcite-font-size--2);--calcite-combobox-item-spacing-unit-l:0.5rem;--calcite-combobox-item-spacing-unit-s:0.25rem;--calcite-combobox-input-height:1.5rem}:host([scale=m]){font-size:var(--calcite-font-size--1);--calcite-combobox-item-spacing-unit-l:0.75rem;--calcite-combobox-item-spacing-unit-s:0.5rem;--calcite-combobox-input-height:2rem}:host([scale=l]){font-size:var(--calcite-font-size-0);--calcite-combobox-item-spacing-unit-l:1rem;--calcite-combobox-item-spacing-unit-s:0.75rem;--calcite-combobox-input-height:2.75rem}.wrapper{display:-ms-flexbox;display:flex;background-color:var(--calcite-ui-foreground-1);color:var(--calcite-ui-text-1);outline-offset:0;outline-color:transparent;-webkit-transition:outline-offset 100ms ease-in-out, outline-color 100ms ease-in-out;transition:outline-offset 100ms ease-in-out, outline-color 100ms ease-in-out;-webkit-box-shadow:inset 0 0 0 1px var(--calcite-ui-border-input);box-shadow:inset 0 0 0 1px var(--calcite-ui-border-input);padding:0 var(--calcite-combobox-item-spacing-unit-l) 0 var(--calcite-combobox-item-spacing-unit-l)}:host(:focus-within) .wrapper,.wrapper--active{outline:2px solid var(--calcite-ui-brand);outline-offset:-2px}.wrapper--single{padding:0 var(--calcite-combobox-item-spacing-unit-l);cursor:pointer;-ms-flex-wrap:nowrap;flex-wrap:nowrap}.grid-input{display:-ms-flexbox;display:flex;-ms-flex-positive:1;flex-grow:1;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-align:center;align-items:center;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:0px}.input{-ms-flex-positive:1;flex-grow:1;-webkit-appearance:none;-moz-appearance:none;appearance:none;border-style:none;background-color:transparent;padding:0px;font-family:inherit;color:var(--calcite-ui-text-1);font-size:inherit;height:var(--calcite-combobox-input-height);line-height:var(--calcite-combobox-input-height);min-width:120px;margin-bottom:var(--calcite-combobox-item-spacing-unit-s)}.input:focus{outline:2px solid transparent;outline-offset:2px}.input--transparent{opacity:0}.input--single{margin-bottom:0px;margin-top:0px;padding:0px}.wrapper--active .input-single{cursor:text}.input--hidden{pointer-events:none;width:0px;min-width:0px;opacity:0}.input--icon{padding:0 var(--calcite-combobox-item-spacing-unit-l)}.input-wrap{display:-ms-flexbox;display:flex;-ms-flex-positive:1;flex-grow:1}.input-wrap--single{-ms-flex:1 1 0%;flex:1 1 0%;overflow:hidden}.label{pointer-events:none;display:-ms-flexbox;display:flex;max-width:100%;-ms-flex:1 1 auto;flex:1 1 auto;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:0px;font-weight:var(--calcite-font-weight-normal);height:var(--calcite-combobox-input-height);line-height:var(--calcite-combobox-input-height)}.label--spaced{padding-top:0px;padding-bottom:0px;padding-left:var(--calcite-combobox-item-spacing-unit-l);padding-right:var(--calcite-combobox-item-spacing-unit-l)}.icon-end,.icon-start{display:-ms-flexbox;display:flex;width:1rem;cursor:pointer;-ms-flex-align:center;align-items:center}.icon-end{-ms-flex:none;flex:none}.popper-container{width:100%;display:block;position:absolute;z-index:900;-webkit-transform:scale(0);transform:scale(0);visibility:hidden;pointer-events:none}.popper-container .calcite-popper-anim{position:relative;z-index:1;-webkit-transition:var(--calcite-popper-transition);transition:var(--calcite-popper-transition);visibility:hidden;-webkit-transition-property:visibility, opacity, -webkit-transform;transition-property:visibility, opacity, -webkit-transform;transition-property:transform, visibility, opacity;transition-property:transform, visibility, opacity, -webkit-transform;opacity:0;-webkit-box-shadow:0 0 16px 0 rgba(0, 0, 0, 0.16);box-shadow:0 0 16px 0 rgba(0, 0, 0, 0.16);border-radius:0.25rem}.popper-container[data-popper-placement^=bottom] .calcite-popper-anim{-webkit-transform:translateY(-5px);transform:translateY(-5px)}.popper-container[data-popper-placement^=top] .calcite-popper-anim{-webkit-transform:translateY(5px);transform:translateY(5px)}.popper-container[data-popper-placement^=left] .calcite-popper-anim{-webkit-transform:translateX(5px);transform:translateX(5px)}.popper-container[data-popper-placement^=right] .calcite-popper-anim{-webkit-transform:translateX(-5px);transform:translateX(-5px)}.popper-container[data-popper-placement] .calcite-popper-anim--active{opacity:1;visibility:visible;-webkit-transform:translate(0);transform:translate(0)}.popper-container--active{pointer-events:initial;visibility:visible}.screen-readers-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}.list-container{max-height:100vh;overflow-y:auto;background-color:var(--calcite-ui-foreground-1);width:var(--calcite-dropdown-width)}.list{margin:0px;display:block;padding:0px}.list--hide{height:0px;overflow:hidden}.chip{margin-block:calc(var(--calcite-combobox-item-spacing-unit-s) / 2) 0;margin-inline:0 var(--calcite-combobox-item-spacing-unit-s);max-width:100%}.chip--active{background-color:var(--calcite-ui-foreground-3)}.chip:last-of-type{-webkit-margin-end:0;margin-inline-end:0}.item{display:block}::slotted(input[slot=hidden-form-input]){bottom:0 !important;left:0 !important;margin:0 !important;opacity:0 !important;outline:none !important;padding:0 !important;position:absolute !important;right:0 !important;top:0 !important;-webkit-transform:none !important;transform:none !important;-webkit-appearance:none !important;z-index:-1 !important}",oe=e=>e.tagName===D,re="combobox-item-",H="combobox-chip-",f="combobox-label-",b="combobox-listbox-",S="combobox-input-";let m=class extends M{constructor(){super();this.__registerHost(),this.__attachShadow(),this.calciteLookupChange=d(this,"calciteLookupChange",7),this.calciteComboboxChange=d(this,"calciteComboboxChange",7),this.calciteComboboxFilterChange=d(this,"calciteComboboxFilterChange",7),this.calciteComboboxChipDismiss=d(this,"calciteComboboxChipDismiss",7),this.calciteComboboxOpen=d(this,"calciteComboboxOpen",7),this.calciteComboboxClose=d(this,"calciteComboboxClose",7),this.active=!1,this.disabled=!1,this.maxItems=0,this.overlayPositioning="absolute",this.required=!1,this.selectionMode="multi",this.scale="m",this.value=null,this.intlRemoveTag=N.removeTag,this.internalValueChangeFlag=!1,this.items=[],this.groupItems=[],this.selectedItems=[],this.visibleItems=[],this.hideList=!this.active,this.activeItemIndex=-1,this.activeChipIndex=-1,this.activeDescendant="",this.text="",this.open=this.active,this.textInput=null,this.mutationObserver=g("mutation",()=>this.updateItems()),this.resizeObserver=g("resize",()=>this.setMaxScrollerHeight()),this.guid=T(),this.inputHeight=0,this.ignoreSelectedEventsFlag=!1,this.activeTransitionProp="opacity",this.getValue=()=>{const e=this.selectedItems.map(t=>t==null?void 0:t.value.toString());return(e==null?void 0:e.length)?e.length>1?e:e[0]:""},this.onLabelClick=()=>{this.setFocus()},this.keydownHandler=e=>{const{key:t}=e;switch(t){case"Tab":this.activeChipIndex=-1,this.activeItemIndex=-1,this.allowCustomValues&&this.text?(this.addCustomChip(this.text,!0),e.preventDefault()):this.active=!1;break;case"ArrowLeft":this.previousChip();break;case"ArrowRight":this.nextChip();break;case"ArrowUp":e.preventDefault(),this.active=!0,this.shiftActiveItemIndex(-1);break;case"ArrowDown":e.preventDefault(),this.active=!0,this.shiftActiveItemIndex(1);break;case"Home":this.active=!0,this.updateActiveItemIndex(0);break;case"End":this.active=!0,this.updateActiveItemIndex(this.visibleItems.length-1);break;case"Escape":this.active=!1;break;case"Enter":this.activeItemIndex>-1?this.toggleSelection(this.visibleItems[this.activeItemIndex]):this.activeChipIndex>-1?this.removeActiveChip():this.allowCustomValues&&this.text&&this.addCustomChip(this.text,!0);break;case"Delete":case"Backspace":this.activeChipIndex>-1?this.removeActiveChip():!this.text&&this.isMulti()&&this.removeLastChip();break;default:this.active||this.setFocus();break}},this.toggleCloseEnd=()=>{this.hideList=!0,this.el.removeEventListener("calciteComboboxClose",this.toggleCloseEnd)},this.toggleOpenEnd=()=>{this.hideList=!1,this.el.removeEventListener("calciteComboboxOpen",this.toggleOpenEnd)},this.transitionEnd=e=>{e.propertyName===this.activeTransitionProp&&(this.active?this.calciteComboboxOpen.emit():this.calciteComboboxClose.emit())},this.setMaxScrollerHeight=()=>{const{active:e,listContainerEl:t}=this;if(!t||!e)return;this.reposition();const i=this.getMaxScrollerHeight();t.style.maxHeight=i>0?`${i}px`:"",this.reposition()},this.calciteChipDismissHandler=(e,t)=>{this.active=!1;const i=this.items.find(s=>s===t);i&&this.toggleSelection(i,!1),this.calciteComboboxChipDismiss.emit(e.detail)},this.setFocusClick=e=>{e.composedPath().some(t=>t.tagName==="CALCITE-CHIP")||this.setFocus()},this.setInactiveIfNotContained=e=>{const t=e.composedPath();!this.active&&!this.open||t.includes(this.el)||t.includes(this.referenceEl)||(this.allowCustomValues&&this.text&&this.addCustomChip(this.text),this.selectionMode==="single"&&(this.textInput&&(this.textInput.value=""),this.text="",this.filterItems(""),this.updateActiveItemIndex(-1)),this.active=!1,this.open=!1)},this.setMenuEl=e=>{this.menuEl=e},this.setListContainerEl=e=>{this.resizeObserver.observe(e),this.listContainerEl=e},this.setReferenceEl=e=>{this.referenceEl=e},this.inputHandler=e=>{const t=e.target.value;this.text=t,this.filterItems(t),t&&(this.activeChipIndex=-1)},this.filterItems=(()=>{const e=(t,i)=>t&&i.some(({label:s,value:n})=>oe(t)?n===t.label||n===t.label:n===t.textLabel||n===t.value||s===t.textLabel||s===t.value);return u(t=>{const i=ne(this.data,t);this.getCombinedItems().forEach(n=>{const o=!e(n,i);n.hidden=o;const[r,h]=n.ancestors;(e(r,i)||e(h,i))&&(n.hidden=!1),o||n.ancestors.forEach(c=>c.hidden=!1)}),this.visibleItems=this.getVisibleItems(),this.calciteComboboxFilterChange.emit({visibleItems:[...this.visibleItems],text:t})},100)})(),this.internalCalciteLookupChangeEvent=()=>{this.calciteLookupChange.emit(this.selectedItems)},this.emitCalciteLookupChange=u(this.internalCalciteLookupChangeEvent,0),this.internalComboboxChangeEvent=()=>{const{selectedItems:e}=this;this.calciteComboboxChange.emit({selectedItems:e})},this.emitComboboxChange=u(this.internalComboboxChangeEvent,0),this.updateItems=()=>{this.items=this.getItems(),this.groupItems=this.getGroupItems(),this.data=this.getData(),this.selectedItems=this.getSelectedItems(),this.visibleItems=this.getVisibleItems(),this.needsIcon=this.getNeedsIcon(),this.allowCustomValues||this.setMaxScrollerHeight()},this.comboboxFocusHandler=()=>{var e;this.active=!0,(e=this.textInput)===null||e===void 0||e.focus()},this.comboboxBlurHandler=e=>{this.setInactiveIfNotContained(e)}}activeHandler(e,t){t&&!e?(this.el.addEventListener("calciteComboboxClose",this.toggleCloseEnd),this.open=!1):!t&&e&&(this.el.addEventListener("calciteComboboxOpen",this.toggleOpenEnd),this.open=!0),this.reposition()}maxItemsHandler(){this.setMaxScrollerHeight()}valueHandler(e){if(!this.internalValueChangeFlag){const t=this.getItems();Array.isArray(e)?t.forEach(i=>i.selected=e.includes(i.value)):e?t.forEach(i=>i.selected=e===i.value):t.forEach(i=>i.selected=!1),this.updateItems()}}documentClickHandler(e){this.setInactiveIfNotContained(e)}calciteComboboxItemChangeHandler(e){if(this.ignoreSelectedEventsFlag)return;const t=e.target;this.toggleSelection(t,t.selected)}async reposition(){const{popper:e,menuEl:t}=this,i=this.getModifiers();e?await $({el:t,modifiers:i,placement:I,popper:e}):this.createPopper()}async setFocus(){var e;this.active=!0,(e=this.textInput)===null||e===void 0||e.focus(),this.activeChipIndex=-1,this.activeItemIndex=-1}connectedCallback(){var e;this.internalValueChangeFlag=!0,this.value=this.getValue(),this.internalValueChangeFlag=!1,(e=this.mutationObserver)===null||e===void 0||e.observe(this.el,{childList:!0,subtree:!0}),this.createPopper(),Y(this),K(this)}componentWillLoad(){this.updateItems()}componentDidLoad(){W(this,this.getValue())}componentDidRender(){this.el.offsetHeight!==this.inputHeight&&(this.reposition(),this.inputHeight=this.el.offsetHeight)}disconnectedCallback(){var e,t;(e=this.mutationObserver)===null||e===void 0||e.disconnect(),(t=this.resizeObserver)===null||t===void 0||t.disconnect(),this.destroyPopper(),G(this),J(this)}selectedItemsHandler(){this.internalValueChangeFlag=!0,this.value=this.getValue(),this.internalValueChangeFlag=!1}textHandler(){this.updateActiveItemIndex(-1)}getModifiers(){const e={name:"flip",enabled:!0};return e.options={fallbackPlacements:["top-start","top","top-end","bottom-start","bottom","bottom-end"]},[e]}createPopper(){this.destroyPopper();const{menuEl:e,referenceEl:t,overlayPositioning:i}=this,s=this.getModifiers();this.popper=P({el:e,modifiers:s,overlayPositioning:i,placement:I,referenceEl:t})}destroyPopper(){const{popper:e}=this;e&&e.destroy(),this.popper=null}getMaxScrollerHeight(){const e=this.getCombinedItems().filter(n=>!n.hidden),{maxItems:t}=this;let i=0,s=0;return e.length>t&&e.forEach(n=>{if(i<t&&t>0){const o=this.calculateSingleItemHeight(n);o>0&&(s+=o,i++)}}),s}calculateSingleItemHeight(e){let t=e.offsetHeight;return Array.from(e.querySelectorAll(U)).map(s=>s==null?void 0:s.offsetHeight).forEach(s=>{t-=s}),t}getCombinedItems(){return[...this.groupItems,...this.items]}toggleSelection(e,t=!e.selected){!e||(this.isMulti()?(e.selected=t,this.updateAncestors(e),this.selectedItems=this.getSelectedItems(),this.emitCalciteLookupChange(),this.emitComboboxChange(),this.resetText(),this.filterItems("")):(this.ignoreSelectedEventsFlag=!0,this.items.forEach(i=>i.selected=i===e?t:!1),this.ignoreSelectedEventsFlag=!1,this.selectedItems=this.getSelectedItems(),this.emitComboboxChange(),this.textInput&&(this.textInput.value=e.textLabel),this.active=!1,this.updateActiveItemIndex(-1),this.resetText(),this.filterItems("")))}updateAncestors(e){if(this.selectionMode!=="ancestors")return;const t=C(e),i=X(e);e.selected?t.forEach(s=>{s.selected=!0}):(i.forEach(s=>s.selected=!1),[...t].forEach(s=>{w(s)||(s.selected=!1)}))}getVisibleItems(){return this.items.filter(e=>!e.hidden)}getSelectedItems(){if(!this.isMulti()){const e=this.items.find(({selected:t})=>t);return e?[e]:[]}return this.items.filter(e=>e.selected&&(this.selectionMode!=="ancestors"||!w(e))).sort((e,t)=>{const i=this.selectedItems.indexOf(e),s=this.selectedItems.indexOf(t);return i>-1&&s>-1?i-s:s-i})}getData(){return this.items.map(e=>({constant:e.constant,value:e.value,label:e.textLabel,guid:e.guid}))}getNeedsIcon(){return this.selectionMode==="single"&&this.items.some(e=>e.icon)}resetText(){this.textInput&&(this.textInput.value=""),this.text=""}getItems(){return Array.from(this.el.querySelectorAll(y)).filter(t=>!t.disabled)}getGroupItems(){return Array.from(this.el.querySelectorAll(D))}addCustomChip(e,t){const i=this.items.find(s=>s.textLabel===e);if(i)this.toggleSelection(i,!0);else{this.isMulti()||this.toggleSelection(this.selectedItems[this.selectedItems.length-1],!1);const s=document.createElement(y);s.value=e,s.textLabel=e,s.selected=!0,this.el.appendChild(s),this.resetText(),t&&this.setFocus(),this.updateItems(),this.filterItems(""),this.emitCalciteLookupChange(),this.emitComboboxChange()}}removeActiveChip(){this.toggleSelection(this.selectedItems[this.activeChipIndex],!1),this.setFocus()}removeLastChip(){this.toggleSelection(this.selectedItems[this.selectedItems.length-1],!1),this.setFocus()}previousChip(){if(this.text)return;const e=this.selectedItems.length-1,t=this.activeChipIndex;this.activeChipIndex=t===-1?e:Math.max(t-1,0),this.updateActiveItemIndex(-1),this.focusChip()}nextChip(){if(this.text||this.activeChipIndex===-1)return;const e=this.selectedItems.length-1,t=this.activeChipIndex+1;t>e?(this.activeChipIndex=-1,this.setFocus()):(this.activeChipIndex=t,this.focusChip()),this.updateActiveItemIndex(-1)}focusChip(){var e;const t=(e=this.selectedItems[this.activeChipIndex])===null||e===void 0?void 0:e.guid,i=t?this.referenceEl.querySelector(`#${H}${t}`):null;i==null||i.setFocus()}shiftActiveItemIndex(e){const t=this.visibleItems.length,i=(this.activeItemIndex+t+e)%t;this.updateActiveItemIndex(i);const s=this.visibleItems[this.activeItemIndex],n=this.calculateSingleItemHeight(s),{offsetHeight:o,scrollTop:r}=this.listContainerEl;o+r<s.offsetTop+n?this.listContainerEl.scrollTop=s.offsetTop-o+n:s.offsetTop<r&&(this.listContainerEl.scrollTop=s.offsetTop)}updateActiveItemIndex(e){var t;this.activeItemIndex=e;let i=null;this.visibleItems.forEach((s,n)=>{n===e?(s.active=!0,i=s.guid):s.active=!1}),this.activeDescendant=i,this.activeItemIndex>-1&&(this.activeChipIndex=-1,(t=this.textInput)===null||t===void 0||t.focus())}isMulti(){return this.selectionMode!=="single"}renderChips(){const{activeChipIndex:e,scale:t,selectionMode:i,intlRemoveTag:s}=this;return this.selectedItems.map((n,o)=>{const r={chip:!0,"chip--active":e===o},c=[...[...C(n)].reverse(),n].map(l=>l.textLabel),p=i!=="ancestors"?n.textLabel:c.join(" / ");return a("calcite-chip",{class:r,dismissLabel:s,dismissible:!0,icon:n.icon,id:n.guid?`${H}${n.guid}`:null,key:n.textLabel,onCalciteChipDismiss:l=>this.calciteChipDismissHandler(l,n),scale:t,title:p,value:n.value},p)})}renderInput(){const{guid:e,active:t,disabled:i,placeholder:s,selectionMode:n,needsIcon:o,selectedItems:r}=this,h=n==="single",c=r[0],p=!t&&h&&!!c;return a("span",{class:{"input-wrap":!0,"input-wrap--single":h}},p&&a("span",{class:{label:!0,"label--spaced":o},key:"label",onFocus:this.comboboxFocusHandler,tabindex:"0"},c.textLabel),a("input",{"aria-activedescendant":this.activeDescendant,"aria-autocomplete":"list","aria-controls":`${b}${e}`,"aria-label":j(this),class:{input:!0,"input--single":!0,"input--transparent":this.activeChipIndex>-1,"input--hidden":p,"input--icon":h&&o},disabled:i,id:`${S}${e}`,key:"input",onBlur:this.comboboxBlurHandler,onFocus:this.comboboxFocusHandler,onInput:this.inputHandler,placeholder:s,ref:l=>this.textInput=l,type:"text"}))}renderListBoxOptions(){return this.visibleItems.map(e=>a("li",{"aria-selected":(!!e.selected).toString(),id:e.guid?`${re}${e.guid}`:null,role:"option",tabindex:"-1"},e.textLabel))}renderPopperContainer(){const{active:e,setMenuEl:t,setListContainerEl:i,hideList:s,open:n}=this,o={"list-container":!0,[v.animation]:!0,[v.animationActive]:e};return a("div",{"aria-hidden":"true",class:{"popper-container":!0,"popper-container--active":n},ref:t},a("div",{class:o,onTransitionEnd:this.transitionEnd,ref:i},a("ul",{class:{list:!0,"list--hide":s}},a("slot",null))))}renderIconStart(){const{selectionMode:e,needsIcon:t,selectedItems:i}=this,s=i[0];return e==="single"&&t&&a("span",{class:"icon-start"},(s==null?void 0:s.icon)&&a("calcite-icon",{class:"selected-icon",icon:s.icon,scale:"s"}))}renderIconEnd(){return a("span",{class:"icon-end"},a("calcite-icon",{icon:"chevron-down",scale:"s"}))}render(){const{guid:e,open:t,label:i}=this,s=this.selectionMode==="single";return a(_,{onKeyDown:this.keydownHandler},a("div",{"aria-autocomplete":"list","aria-expanded":t.toString(),"aria-haspopup":"listbox","aria-labelledby":`${f}${e}`,"aria-owns":`${b}${e}`,class:{wrapper:!0,"wrapper--single":s||!this.selectedItems.length,"wrapper--active":t},onClick:this.setFocusClick,ref:this.setReferenceEl,role:"combobox"},a("div",{class:"grid-input"},this.renderIconStart(),!s&&this.renderChips(),a("label",{class:"screen-readers-only",htmlFor:`${S}${e}`,id:`${f}${e}`},i),this.renderInput()),this.renderIconEnd()),a("ul",{"aria-labelledby":`${f}${e}`,"aria-multiselectable":"true",class:"screen-readers-only",id:`${b}${e}`,role:"listbox",tabIndex:-1},this.renderListBoxOptions()),this.renderPopperContainer(),a(Q,{component:this}))}get el(){return this}static get watchers(){return{active:["activeHandler"],maxItems:["maxItemsHandler"],value:["valueHandler"],selectedItems:["selectedItemsHandler"],text:["textHandler"]}}static get style(){return ae}};m=O(m,[1,"calcite-combobox",{active:[1540],disabled:[516],label:[1],placeholder:[1],maxItems:[2,"max-items"],name:[513],allowCustomValues:[4,"allow-custom-values"],overlayPositioning:[1,"overlay-positioning"],required:[4],selectionMode:[513,"selection-mode"],scale:[513],value:[1025],intlRemoveTag:[1,"intl-remove-tag"],items:[32],groupItems:[32],selectedItems:[32],visibleItems:[32],needsIcon:[32],hideList:[32],activeItemIndex:[32],activeChipIndex:[32],activeDescendant:[32],text:[32],open:[32],reposition:[64],setFocus:[64]},[[4,"click","documentClickHandler"],[0,"calciteComboboxItemChange","calciteComboboxItemChangeHandler"]]]);function F(){if(typeof customElements=="undefined")return;["calcite-combobox","calcite-chip","calcite-icon"].forEach(t=>{switch(t){case"calcite-combobox":customElements.get(t)||customElements.define(t,m);break;case"calcite-chip":customElements.get(t)||z();break;case"calcite-icon":customElements.get(t)||V();break}})}F();const me=m,ue=F;export{me as CalciteCombobox,ue as defineCustomElement};
